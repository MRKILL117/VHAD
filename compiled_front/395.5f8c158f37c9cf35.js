"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[395],{7395:(w,d,u)=>{u.r(d),u.d(d,{ProfileModule:()=>xe});var g=u(6019),C=u(9845),i=u(7537),p=u(1859),c=u(4611),e=u(1514),m=u(7754),_=u(6588),h=u(830),Z=u(3149);const f=["firstTimeConfigurationModal"];function x(n,l){1&n&&(e.TgZ(0,"div",47),e._UZ(1,"i",48),e.qZA())}function A(n,l){if(1&n&&(e.TgZ(0,"div",49),e._UZ(1,"img",50),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Q6J("src",o.file.GenerateFileURL(o.user.profileImage.partialURL),e.LSH)("alt",o.user.profileImage.name)}}function v(n,l){if(1&n&&(e.TgZ(0,"div",63),e._UZ(1,"img",64),e.qZA()),2&n){const o=e.oxw(2);e.xp6(1),e.Q6J("src",o.newProfileImagePreview,e.LSH)}}function P(n,l){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",65),e.qZA())}function q(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Guardar"),e.qZA())}function F(n,l){if(1&n){const o=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h4",51),e._uU(3,"Cambiar foto de perfil"),e.qZA(),e.TgZ(4,"button",52),e.NdJ("click",function(){return e.CHM(o),e.oxw().CloseModal()}),e.TgZ(5,"span"),e._uU(6,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",36),e.YNc(8,v,2,1,"div",53),e.TgZ(9,"div",54),e.TgZ(10,"div",55),e.TgZ(11,"label",56),e._uU(12,"Selecciona una imagen"),e.qZA(),e.TgZ(13,"button",46),e.NdJ("click",function(){return e.CHM(o),e.MAs(17).click()}),e._UZ(14,"i",57),e._uU(15," Seleccionar "),e.qZA(),e.qZA(),e.TgZ(16,"input",58,59),e.NdJ("change",function(r){return e.CHM(o),e.oxw().OnProfileImageSelected(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",45),e.TgZ(19,"button",60),e.NdJ("click",function(){e.CHM(o);const r=e.MAs(17),a=e.oxw();return a.CloseModal(),a.CleanFileInput(r)}),e._uU(20," Cancelar "),e.qZA(),e.TgZ(21,"button",61),e.NdJ("click",function(){return e.CHM(o),e.oxw().ChangeProflePicture()}),e.YNc(22,P,2,0,"span",62),e.YNc(23,q,2,0,"span",62),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();e.xp6(8),e.Q6J("ngIf",o.newProfileImagePreview),e.xp6(13),e.Q6J("disabled",o.loading.updating||!o.newProfileImage),e.xp6(1),e.Q6J("ngIf",o.loading.updating),e.xp6(1),e.Q6J("ngIf",!o.loading.updating)}}function b(n,l){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",65),e.qZA())}function N(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Si, eliminar"),e.qZA())}function y(n,l){if(1&n){const o=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h4",51),e._uU(3,"Eliminar cuenta"),e.qZA(),e.TgZ(4,"button",52),e.NdJ("click",function(){return e.CHM(o),e.oxw().CloseModal()}),e.TgZ(5,"span"),e._uU(6,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",36),e.TgZ(8,"div",18),e.TgZ(9,"div",66),e._uU(10," \xbfEst\xe1 seguro/a que desea eliminar su cuenta permanentemente? "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",45),e.TgZ(12,"button",60),e.NdJ("click",function(){return e.CHM(o),e.oxw().CloseModal()}),e._uU(13," No, cancelar "),e.qZA(),e.TgZ(14,"button",67),e.NdJ("click",function(){e.CHM(o);const r=e.oxw(),a=e.MAs(47);return r.OpenModal(a)}),e.YNc(15,b,2,0,"span",62),e.YNc(16,N,2,0,"span",62),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();e.xp6(14),e.Q6J("disabled",o.loading.deleting),e.xp6(1),e.Q6J("ngIf",o.loading.deleting),e.xp6(1),e.Q6J("ngIf",!o.loading.deleting)}}function k(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba su correo o c\xf3digo "),e.qZA())}function I(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,k,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.confirmDeletionForm,"username"))||null==t.errors?null:t.errors.required)}}function J(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba su contrase\xf1a "),e.qZA())}function U(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,J,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.confirmDeletionForm,"password"))||null==t.errors?null:t.errors.required)}}function M(n,l){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",65),e.qZA())}function G(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Eliminar"),e.qZA())}function D(n,l){if(1&n){const o=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h4",51),e._uU(3,"Confirmar acci\xf3n"),e.qZA(),e.TgZ(4,"button",52),e.NdJ("click",function(){return e.CHM(o),e.oxw().CloseModal()}),e.TgZ(5,"span"),e._uU(6,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",36),e.TgZ(8,"form",37),e.TgZ(9,"div",18),e.TgZ(10,"label",68),e._uU(11,"Correo o c\xf3digo"),e.qZA(),e.TgZ(12,"input",69),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().DeleteUser()}),e.qZA(),e.YNc(13,I,2,1,"div",39),e.qZA(),e.TgZ(14,"div",18),e.TgZ(15,"label",41),e._uU(16,"Contrase\xf1a"),e.qZA(),e.TgZ(17,"input",70),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().DeleteUser()}),e.qZA(),e.YNc(18,U,2,1,"div",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",45),e.TgZ(20,"button",60),e.NdJ("click",function(){return e.CHM(o),e.oxw().CloseModal()}),e._uU(21," Cancelar "),e.qZA(),e.TgZ(22,"button",67),e.NdJ("click",function(){return e.CHM(o),e.oxw().DeleteUser()}),e.YNc(23,M,2,0,"span",62),e.YNc(24,G,2,0,"span",62),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();let t,r;e.xp6(8),e.Q6J("formGroup",o.confirmDeletionForm),e.xp6(5),e.Q6J("ngIf",(null==(t=o.form.GetFormControlByName(o.confirmDeletionForm,"username"))?null:t.touched)&&(null==(t=o.form.GetFormControlByName(o.confirmDeletionForm,"username"))?null:t.errors)),e.xp6(5),e.Q6J("ngIf",(null==(r=o.form.GetFormControlByName(o.confirmDeletionForm,"password"))?null:r.touched)&&(null==(r=o.form.GetFormControlByName(o.confirmDeletionForm,"password"))?null:r.errors)),e.xp6(4),e.Q6J("disabled",o.loading.deleting),e.xp6(1),e.Q6J("ngIf",o.loading.deleting),e.xp6(1),e.Q6J("ngIf",!o.loading.deleting)}}function Q(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba su contrase\xf1a actual "),e.qZA())}function Y(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,Q,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.changePasswordForm,"oldPassword"))||null==t.errors?null:t.errors.required)}}function S(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba una contrase\xf1a "),e.qZA())}function E(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,S,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.changePasswordForm,"newPassword"))||null==t.errors?null:t.errors.required)}}function B(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba la confirmaci\xf3n de la contrase\xf1a "),e.qZA())}function O(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Las contrase\xf1as no coinciden "),e.qZA())}function z(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,B,2,0,"span",72),e.YNc(2,O,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.changePasswordForm,"confirmPassword"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.changePasswordForm,"confirmPassword"))||null==r.errors?null:r.errors.matchstring)}}function H(n,l){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",65),e.qZA())}function R(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Cambiar"),e.qZA())}function j(n,l){if(1&n){const o=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h4",51),e._uU(3,"Cambiar contrase\xf1a"),e.qZA(),e.TgZ(4,"button",52),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return r.CloseModal(),r.form.ResetForm(r.changePasswordForm)}),e.TgZ(5,"span"),e._uU(6,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",36),e.TgZ(8,"form",37),e.TgZ(9,"div",18),e.TgZ(10,"label",41),e._uU(11,"Contrase\xf1a actual"),e.qZA(),e.TgZ(12,"input",74),e.NdJ("input",function(){e.CHM(o);const r=e.oxw();return r.form.OnPasswordChange(r.changePasswordForm,"oldPassword","confirmPassword")})("keyup.enter",function(){return e.CHM(o),e.oxw().ChangePassword()}),e.qZA(),e.YNc(13,Y,2,1,"div",39),e.qZA(),e.TgZ(14,"div",18),e.TgZ(15,"label",41),e._uU(16,"Nueva contrase\xf1a"),e.qZA(),e.TgZ(17,"input",75),e.NdJ("input",function(){e.CHM(o);const r=e.oxw();return r.form.OnPasswordChange(r.changePasswordForm,"newPassword","confirmPassword")})("keyup.enter",function(){return e.CHM(o),e.oxw().ChangePassword()}),e.qZA(),e.YNc(18,E,2,1,"div",39),e.qZA(),e.TgZ(19,"div",18),e.TgZ(20,"label",43),e._uU(21,"Confirmar contrase\xf1a"),e.qZA(),e.TgZ(22,"input",44),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().ChangePassword()}),e.qZA(),e.YNc(23,z,3,2,"div",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",45),e.TgZ(25,"button",60),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return r.CloseModal(),r.form.ResetForm(r.changePasswordForm)}),e._uU(26," Cancelar "),e.qZA(),e.TgZ(27,"button",61),e.NdJ("click",function(){return e.CHM(o),e.oxw().ChangePassword()}),e.YNc(28,H,2,0,"span",62),e.YNc(29,R,2,0,"span",62),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();let t,r,a;e.xp6(8),e.Q6J("formGroup",o.changePasswordForm),e.xp6(5),e.Q6J("ngIf",(null==(t=o.form.GetFormControlByName(o.changePasswordForm,"oldPassword"))?null:t.touched)&&(null==(t=o.form.GetFormControlByName(o.changePasswordForm,"oldPassword"))?null:t.errors)),e.xp6(5),e.Q6J("ngIf",(null==(r=o.form.GetFormControlByName(o.changePasswordForm,"newPassword"))?null:r.touched)&&(null==(r=o.form.GetFormControlByName(o.changePasswordForm,"newPassword"))?null:r.errors)),e.xp6(5),e.Q6J("ngIf",(null==(a=o.form.GetFormControlByName(o.changePasswordForm,"confirmPassword"))?null:a.touched)&&(null==(a=o.form.GetFormControlByName(o.changePasswordForm,"confirmPassword"))?null:a.errors)),e.xp6(4),e.Q6J("disabled",o.loading.changingPassword),e.xp6(1),e.Q6J("ngIf",o.loading.changingPassword),e.xp6(1),e.Q6J("ngIf",!o.loading.changingPassword)}}function V(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Seleccione un rol para el usuario "),e.qZA())}function L(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,V,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.userForm,"role"))||null==t.errors?null:t.errors.required)}}function $(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba nombre del titular de la cuenta "),e.qZA())}function W(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," M\xednimo 3 caracteres "),e.qZA())}function X(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,$,2,0,"span",72),e.YNc(2,W,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.userForm,"name"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.userForm,"name"))||null==r.errors?null:r.errors.minlength)}}function K(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba email del titular de la cuenta "),e.qZA())}function ee(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Email inv\xe1lido "),e.qZA())}function oe(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,K,2,0,"span",72),e.YNc(2,ee,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.userForm,"email"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.userForm,"email"))||null==r.errors?null:r.errors.pattern)}}function te(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba su tel\xe9fono "),e.qZA())}function ne(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Tel\xe9fono inv\xe1lido "),e.qZA())}function re(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,te,2,0,"span",72),e.YNc(2,ne,2,0,"span",72),e.qZA()),2&n){const o=e.oxw(2);let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.userForm,"cellphone"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.userForm,"cellphone"))||null==r.errors?null:r.errors.pattern)}}function le(n,l){1&n&&(e.TgZ(0,"span"),e._UZ(1,"i",65),e.qZA())}function ie(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Guardar"),e.qZA())}function ae(n,l){if(1&n){const o=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"h4",51),e._uU(3,"Editar cuenta"),e.qZA(),e.TgZ(4,"button",52),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return r.CloseModal(),r.form.ResetForm(r.userForm)}),e.TgZ(5,"span"),e._uU(6,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",36),e.TgZ(8,"form",37),e.TgZ(9,"div",18),e.TgZ(10,"label",76),e._uU(11,"Rol de usuario"),e.qZA(),e._UZ(12,"ng-select",77),e.YNc(13,L,2,1,"div",39),e.qZA(),e.TgZ(14,"div",18),e.TgZ(15,"label",78),e._uU(16,"Nombre"),e.qZA(),e.TgZ(17,"input",79),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().UpdateAccount()}),e.qZA(),e.YNc(18,X,3,2,"div",39),e.qZA(),e.TgZ(19,"div",18),e.TgZ(20,"label",80),e._uU(21,"Email"),e.qZA(),e.TgZ(22,"input",81),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().UpdateAccount()}),e.qZA(),e.YNc(23,oe,3,2,"div",39),e.qZA(),e.TgZ(24,"div",18),e.TgZ(25,"label",80),e._uU(26,"Tel\xe9fono"),e.qZA(),e.TgZ(27,"input",82),e.NdJ("keyup.enter",function(){return e.CHM(o),e.oxw().UpdateAccount()}),e.qZA(),e.YNc(28,re,3,2,"div",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(29,"div",45),e.TgZ(30,"button",60),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return r.CloseModal(),r.form.ResetForm(r.userForm)}),e._uU(31," Cancelar "),e.qZA(),e.TgZ(32,"button",83),e.NdJ("click",function(){return e.CHM(o),e.oxw().UpdateAccount()}),e.YNc(33,le,2,0,"span",62),e.YNc(34,ie,2,0,"span",62),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();let t,r,a,s;e.xp6(8),e.Q6J("formGroup",o.userForm),e.xp6(4),e.Q6J("readonly",!0)("items",o.roles),e.xp6(1),e.Q6J("ngIf",(null==(t=o.form.GetFormControlByName(o.userForm,"role"))?null:t.touched)&&(null==(t=o.form.GetFormControlByName(o.userForm,"role"))?null:t.errors)),e.xp6(5),e.Q6J("ngIf",(null==(r=o.form.GetFormControlByName(o.userForm,"name"))?null:r.touched)&&(null==(r=o.form.GetFormControlByName(o.userForm,"name"))?null:r.errors)),e.xp6(5),e.Q6J("ngIf",(null==(a=o.form.GetFormControlByName(o.userForm,"email"))?null:a.touched)&&(null==(a=o.form.GetFormControlByName(o.userForm,"email"))?null:a.errors)),e.xp6(5),e.Q6J("ngIf",(null==(s=o.form.GetFormControlByName(o.userForm,"cellphone"))?null:s.touched)&&(null==(s=o.form.GetFormControlByName(o.userForm,"cellphone"))?null:s.errors)),e.xp6(4),e.Q6J("disabled",o.loading.updating),e.xp6(1),e.Q6J("ngIf",o.loading.updating),e.xp6(1),e.Q6J("ngIf",!o.loading.updating)}}function se(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Ingrese su nombre "),e.qZA())}function me(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," M\xednimo 3 caracteres "),e.qZA())}function ue(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,se,2,0,"span",72),e.YNc(2,me,2,0,"span",72),e.qZA()),2&n){const o=e.oxw();let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.firstTimeConfigForm,"name"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.firstTimeConfigForm,"name"))||null==r.errors?null:r.errors.minlength)}}function ce(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Ingrese un email "),e.qZA())}function _e(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Email inv\xe1lido "),e.qZA())}function pe(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,ce,2,0,"span",72),e.YNc(2,_e,2,0,"span",72),e.qZA()),2&n){const o=e.oxw();let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.firstTimeConfigForm,"email"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.firstTimeConfigForm,"email"))||null==r.errors?null:r.errors.pattern)}}function fe(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Escriba una contrase\xf1a "),e.qZA())}function de(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,fe,2,0,"span",72),e.qZA()),2&n){const o=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.firstTimeConfigForm,"password"))||null==t.errors?null:t.errors.required)}}function ge(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Confirme la contrase\xf1a "),e.qZA())}function Ze(n,l){1&n&&(e.TgZ(0,"span",73),e._uU(1," Las contrase\xf1as no coinciden "),e.qZA())}function Te(n,l){if(1&n&&(e.TgZ(0,"div",71),e.YNc(1,ge,2,0,"span",72),e.YNc(2,Ze,2,0,"span",72),e.qZA()),2&n){const o=e.oxw();let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.form.GetFormControlByName(o.firstTimeConfigForm,"confirmPassword"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=o.form.GetFormControlByName(o.firstTimeConfigForm,"confirmPassword"))||null==r.errors?null:r.errors.matchstring)}}const Ce=function(){return{backdrop:"static",keyboard:!1}},he=[{path:"",component:(()=>{class n{constructor(o,t,r,a,s){this.http=o,this.toast=t,this.form=r,this.modalService=a,this.file=s,this.modalRefs=[],this.newProfileImage=null,this.newProfileImagePreview=null,this.roles=[],this.loading={deleting:!1,updating:!1,changingPassword:!1},this.userForm=new i.cw({role:new i.NI(null,[i.kI.required]),name:new i.NI("",[i.kI.required,i.kI.minLength(3)]),email:new i.NI("",[i.kI.required,i.kI.pattern(this.form.emailRegex)]),cellphone:new i.NI("",[i.kI.required,i.kI.pattern(/^[0-9]{10}$/)])}),this.changePasswordForm=new i.cw({oldPassword:new i.NI("",[i.kI.required]),newPassword:new i.NI("",[i.kI.required]),confirmPassword:new i.NI("",[i.kI.required])}),this.confirmDeletionForm=new i.cw({username:new i.NI("",[i.kI.required,i.kI.pattern(this.form.emailOrCodeRegex)]),password:new i.NI("",[i.kI.required])}),this.firstTimeConfigForm=new i.cw({name:new i.NI("",[i.kI.required,i.kI.minLength(3)]),email:new i.NI("",[i.kI.required,i.kI.pattern(this.form.emailRegex)]),password:new i.NI("",[i.kI.required]),confirmPassword:new i.NI("",[i.kI.required])})}ngOnInit(){this.GetRoles();const o=localStorage.getItem("user");this.user=o?JSON.parse(o):null,o&&this.confirmDeletionForm.controls.username.setValue(this.user.email),this.CheckUserFirstConfiguration()}OpenModal(o){this.modalRefs.push(this.modalService.show(o,{backdrop:"static",keyboard:!1}))}CloseModal(){this.modalRefs.length&&this.modalRefs.pop().hide()}CloseFirstTimeConfigurationModal(){if(!this.firstTimeConfigForm.valid)return this.toast.ShowDefaultWarning("Favor de llenar el formulario","Datos incompletos"),void this.firstTimeConfigForm.markAllAsTouched();this.SaveAccountData(this.firstTimeConfigForm.value)}CheckUserFirstConfiguration(){this.user&&!this.user.firstTimeConfiguration&&setTimeout(()=>{var o;null===(o=this.firstTimeConfigurationModal)||void 0===o||o.show()},10)}OnProfileImageSelected(o){if(o&&o.target){this.newProfileImage=null,this.newProfileImagePreview=null,this.newProfileImage=o.target.files[0];const r=new FileReader;r.onload=a=>{this.newProfileImagePreview=r.result},r.readAsDataURL(this.newProfileImage)}}CleanFileInput(o){this.newProfileImage=null,this.newProfileImagePreview=null,o.value=""}GetRoles(){this.http.Get("/Accounts/Roles").subscribe(o=>{this.roles=o},o=>{console.error("Error al obtener los roles",o)})}PrepareUserToEdit(){this.userForm.controls.role.setValue(this.user.role.name),this.userForm.controls.name.setValue(this.user.name),this.userForm.controls.email.setValue(this.user.email),this.userForm.controls.cellphone.setValue(this.user.cellphone)}SaveAccountData(o){this.http.Patch(`/Accounts/${this.user?this.user.id:0}/FirstTimeConfig`,{accountData:o}).subscribe(t=>{var r;this.http.SetUserSession(t),this.toast.ShowDefaultSuccess("Datos actualizados correctamente"),(null===(r=this.firstTimeConfigurationModal)||void 0===r?void 0:r.isShown)&&this.firstTimeConfigurationModal.hide()},t=>{console.error("Error al actualizar los datos",t),this.toast.ShowDefaultDanger(410==t.error.error.errorCode?"Email ya est\xe1 registrado":"Error al actualizar los datos")})}UpdateAccount(){if(!this.userForm.valid)return void this.toast.ShowDefaultWarning("Favor de completar el formulario","Formulario incompleto");this.loading.updating=!0;let o=Object.assign(Object.assign({},this.userForm.value),{generateToken:!0});this.http.Patch(`/Accounts/${this.user?this.user.id:0}`,{userData:o}).subscribe(t=>{if(this.CloseModal(),this.user=t,t.token){const r=t.token;delete t.token,localStorage.setItem("token",r.id)}localStorage.setItem("user",JSON.stringify(t)),this.toast.ShowDefaultSuccess("Datos actualizados correctamente"),this.loading.updating=!1},t=>{this.toast.ShowDefaultDanger("Error al actualizar cuenta"),console.error("Error al actualizar cuenta",t),this.loading.updating=!1})}DeleteUser(){if(!this.confirmDeletionForm.valid)return this.toast.ShowDefaultWarning("Confirmar identidad","Formulario incompleto"),void this.confirmDeletionForm.markAllAsTouched();let o=this.confirmDeletionForm.value;this.form.emailRegex.test(o.username)&&(o.email=o.username,delete o.username),this.loading.deleting=!0,this.http.Post("/Accounts/VerifyIdentity",{password:o.password}).subscribe(t=>{if(!t)return this.toast.ShowDefaultDanger("Credenciales inv\xe1lidas"),void(this.loading.deleting=!1);this.http.Delete(`/Accounts/${this.user?this.user.id:0}`).subscribe(r=>{localStorage.clear(),this.loading.deleting=!1,location.reload(),this.toast.ShowDefaultSuccess("Cuenta borrada correctamente")},r=>{this.toast.ShowDefaultDanger("Error al borrar cuenta"),console.error("Error al borrar cuenta",r),this.loading.deleting=!1})},t=>{this.toast.ShowDefaultDanger("Error al verificar identidad"),this.loading.deleting=!1})}ChangePassword(){if(!this.changePasswordForm.valid)return this.toast.ShowDefaultWarning("Favor de llenar el formulario correctamente","Formulario inv\xe1lido"),void this.changePasswordForm.markAllAsTouched();this.loading.changingPassword=!0,this.http.Patch(`/Accounts/${this.user?this.user.id:0}/ChangePassword`,Object.assign({},this.changePasswordForm.value)).subscribe(o=>{this.CloseModal(),localStorage.setItem("token",o.id),this.toast.ShowDefaultSuccess("Contrase\xf1a actualizada correctamente"),this.loading.changingPassword=!1},o=>{console.error("Error al cambiar la contrase\xf1a",o),this.toast.ShowDefaultDanger("Error al cambiar la contrase\xf1a"),this.loading.changingPassword=!1})}ChangeProflePicture(){this.newProfileImage?this.file.UploadFile(this.newProfileImage,"profile-images").then(o=>{this.http.Patch(`/Accounts/${this.user?this.user.id:0}/ChangeProfilePicture`,{newImage:o}).subscribe(t=>{this.toast.ShowDefaultSuccess("Imagen actualizada correctamente"),this.user=t,localStorage.setItem("user",JSON.stringify(this.user)),this.CloseModal()},t=>{console.error("Error al actualizar imagen",t),this.toast.ShowDefaultDanger("Error al actualizar imagen")})},o=>{console.error("Error al subir archivo",o),this.toast.ShowDefaultDanger("Error al actualizar imagen")}):this.toast.ShowDefaultWarning("Selecicone una imagen","Archivo no seleccionado")}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(m.O),e.Y36(_.k),e.Y36(h.o),e.Y36(p.tT),e.Y36(Z.I))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile"]],viewQuery:function(o,t){if(1&o&&e.Gf(f,5),2&o){let r;e.iGM(r=e.CRH())&&(t.firstTimeConfigurationModal=r.first)}},decls:84,vars:13,consts:[[1,"row","justify-content-center","mt-5"],[1,"col-12","col-md-10","col-lg-8","col-xl-6","mt-5"],[1,"card"],[1,"card-header","py-0"],[1,"relative-container"],[1,"absolute-container"],["title","Cambiar foto de perfil",1,"square","clickeable",3,"click"],["class","icon-container",4,"ngIf"],["class","img-container",4,"ngIf"],[1,"card-body","row"],[1,"form-group","col-12","col-sm-6","px-0"],["for","username",1,"card-info-label"],[1,"card-info"],["for","name",1,"card-info-label"],["for","email",1,"card-info-label"],[1,"card-footer","pt-0"],[1,"form-group","user-card-info"],[1,"btn","btn-primary","btn-block","mt-2",3,"click"],[1,"form-group"],[1,"d-flex","justify-content-between","mt-2"],[2,"width","45%"],[1,"btn","btn-info","btn-block",3,"click"],[1,"zmdi","zmdi-edit"],[1,"btn","btn-danger","btn-block",3,"click"],[1,"zmdi","zmdi-delete"],["changeUserProfileImageModal",""],["deleteUserModal",""],["confirmDeleteUserModal",""],["changePasswordModal",""],["editUserModal",""],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","first-time-configuration",1,"modal","fade",3,"config"],["firstTimeConfigurationModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","first-time-configuration",1,"modal-title","pull-left"],[1,"modal-body"],[3,"formGroup"],["type","text","formControlName","name","placeholder","Escribe tu nombre",1,"form-control",3,"keyup.enter"],["class","error-messages",4,"ngIf"],["type","text","formControlName","email","placeholder","Escribe tu correo",1,"form-control",3,"keyup.enter"],["for","password"],["type","password","placeholder","Nueva contrase\xf1a","formControlName","password",1,"form-control",3,"input","keyup.enter"],["for","confirmPassword"],["type","password","placeholder","Confirmar contrase\xf1a","formControlName","confirmPassword",1,"form-control",3,"keyup.enter"],[1,"modal-footer"],[1,"btn","btn-primary",3,"click"],[1,"icon-container"],[1,"zmdi","zmdi-account","zmdi-hc-3x"],[1,"img-container"],[2,"height","100%","width","100%","border-radius","50%","object-fit","cover","object-position","center",3,"src","alt"],[1,"modal-title"],[1,"close",3,"click"],["class","w-100 h-100 mb-4",4,"ngIf"],[1,"form-group","h-100"],[1,"d-flex","h-100","align-items-center","justify-content-between"],["for","profileImage",1,"m-0"],[1,"zmdi","zmdi-plus-circle-o"],["type","file","accept","image/*",1,"d-none",3,"change"],["userProfileImageInput",""],[1,"btn","btn-secondary","mr-2",3,"click"],[1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf"],[1,"w-100","h-100","mb-4"],[1,"img-selected",3,"src"],[1,"zmdi","zmdi-spinner","zmdi-hc-spin"],[1,"message-text"],[1,"btn","btn-danger",3,"disabled","click"],["for","username"],["type","text","placeholder","Correo o c\xf3digo","readonly","","formControlName","username",1,"form-control",3,"keyup.enter"],["type","password","placeholder","Contrase\xf1a","formControlName","password",1,"form-control",3,"keyup.enter"],[1,"error-messages"],["class","d-block",4,"ngIf"],[1,"d-block"],["type","password","placeholder","Contrase\xf1a actual","formControlName","oldPassword",1,"form-control",3,"input","keyup.enter"],["type","password","placeholder","Nueva contrase\xf1a","formControlName","newPassword",1,"form-control",3,"input","keyup.enter"],["for","role"],["bindLabel","label","bindValue","name","formControlName","role","placeholder","Selecicone un rol de usuario",3,"readonly","items"],["for","name"],["type","text","placeholder","Escriba nombre del titular de la cuenta","formControlName","name",1,"form-control",3,"keyup.enter"],["for","email"],["type","text","placeholder","Escriba email del titular de la cuenta","formControlName","email",1,"form-control",3,"keyup.enter"],["type","text","placeholder","Escriba su tel\xe9fono","formControlName","cellphone",1,"form-control",3,"keyup.enter"],[1,"btn","btn-info",3,"disabled","click"]],template:function(o,t){if(1&o){const r=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(43);return t.OpenModal(s)}),e.YNc(7,x,2,0,"div",7),e.YNc(8,A,2,2,"div",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",9),e.TgZ(10,"div",10),e.TgZ(11,"label",11),e._uU(12,"Clave"),e.qZA(),e.TgZ(13,"div",12),e._uU(14),e.qZA(),e.qZA(),e.TgZ(15,"div",10),e.TgZ(16,"label",13),e._uU(17,"Nombre"),e.qZA(),e.TgZ(18,"div",12),e._uU(19),e.qZA(),e.qZA(),e.TgZ(20,"div",10),e.TgZ(21,"label",14),e._uU(22,"Correo"),e.qZA(),e.TgZ(23,"div",12),e._uU(24),e.qZA(),e.qZA(),e.TgZ(25,"div",10),e.TgZ(26,"label",14),e._uU(27,"N\xfamero de telefono"),e.qZA(),e.TgZ(28,"div",12),e._uU(29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",15),e.TgZ(31,"div",16),e.TgZ(32,"button",17),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(49);return t.OpenModal(s)}),e._uU(33," Cambiar contrase\xf1a "),e.qZA(),e.qZA(),e.TgZ(34,"div",18),e.TgZ(35,"div",19),e.TgZ(36,"div",20),e.TgZ(37,"button",21),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(51);return t.PrepareUserToEdit(),t.OpenModal(s)}),e._UZ(38,"i",22),e.qZA(),e.qZA(),e.TgZ(39,"div",20),e.TgZ(40,"button",23),e.NdJ("click",function(){e.CHM(r);const s=e.MAs(45);return t.OpenModal(s)}),e._UZ(41,"i",24),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(42,F,24,4,"ng-template",null,25,e.W1O),e.YNc(44,y,17,3,"ng-template",null,26,e.W1O),e.YNc(46,D,25,6,"ng-template",null,27,e.W1O),e.YNc(48,j,30,7,"ng-template",null,28,e.W1O),e.YNc(50,ae,35,10,"ng-template",null,29,e.W1O),e.TgZ(52,"div",30,31),e.TgZ(54,"div",32),e.TgZ(55,"div",33),e.TgZ(56,"div",34),e.TgZ(57,"h4",35),e._uU(58,"Configuraci\xf3n inicial"),e.qZA(),e.qZA(),e.TgZ(59,"div",36),e.TgZ(60,"form",37),e.TgZ(61,"div",18),e.TgZ(62,"label"),e._uU(63,"Nombre"),e.qZA(),e.TgZ(64,"input",38),e.NdJ("keyup.enter",function(){return t.CloseFirstTimeConfigurationModal()}),e.qZA(),e.YNc(65,ue,3,2,"div",39),e.qZA(),e.TgZ(66,"div",18),e.TgZ(67,"label"),e._uU(68,"Email"),e.qZA(),e.TgZ(69,"input",40),e.NdJ("keyup.enter",function(){return t.CloseFirstTimeConfigurationModal()}),e.qZA(),e.YNc(70,pe,3,2,"div",39),e.qZA(),e.TgZ(71,"div",18),e.TgZ(72,"label",41),e._uU(73,"Contrase\xf1a"),e.qZA(),e.TgZ(74,"input",42),e.NdJ("input",function(){return t.form.OnPasswordChange(t.firstTimeConfigForm,"password","confirmPassword")})("keyup.enter",function(){return t.CloseFirstTimeConfigurationModal()}),e.qZA(),e.YNc(75,de,2,1,"div",39),e.qZA(),e.TgZ(76,"div",18),e.TgZ(77,"label",43),e._uU(78,"Confirmar contrase\xf1a"),e.qZA(),e.TgZ(79,"input",44),e.NdJ("keyup.enter",function(){return t.CloseFirstTimeConfigurationModal()}),e.qZA(),e.YNc(80,Te,3,2,"div",39),e.qZA(),e.qZA(),e.qZA(),e.TgZ(81,"div",45),e.TgZ(82,"button",46),e.NdJ("click",function(){return t.CloseFirstTimeConfigurationModal()}),e._uU(83," Guardar "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){let r,a,s,T;e.xp6(7),e.Q6J("ngIf",!t.user.profileImage),e.xp6(1),e.Q6J("ngIf",t.user.profileImage),e.xp6(6),e.hij(" ",null==t.user?null:t.user.username," "),e.xp6(5),e.hij(" ",null==t.user?null:t.user.name," "),e.xp6(5),e.hij(" ",null==t.user?null:t.user.email," "),e.xp6(5),e.hij(" ",null==t.user?null:t.user.cellphone," "),e.xp6(23),e.Q6J("config",e.DdM(12,Ce)),e.xp6(8),e.Q6J("formGroup",t.firstTimeConfigForm),e.xp6(5),e.Q6J("ngIf",(null==(r=t.form.GetFormControlByName(t.firstTimeConfigForm,"name"))?null:r.touched)&&(null==(r=t.form.GetFormControlByName(t.firstTimeConfigForm,"name"))?null:r.errors)),e.xp6(5),e.Q6J("ngIf",(null==(a=t.form.GetFormControlByName(t.firstTimeConfigForm,"email"))?null:a.touched)&&(null==(a=t.form.GetFormControlByName(t.firstTimeConfigForm,"email"))?null:a.errors)),e.xp6(5),e.Q6J("ngIf",(null==(s=t.form.GetFormControlByName(t.firstTimeConfigForm,"password"))?null:s.touched)&&(null==(s=t.form.GetFormControlByName(t.firstTimeConfigForm,"password"))?null:s.errors)),e.xp6(5),e.Q6J("ngIf",(null==(T=t.form.GetFormControlByName(t.firstTimeConfigForm,"confirmPassword"))?null:T.touched)&&(null==(T=t.form.GetFormControlByName(t.firstTimeConfigForm,"confirmPassword"))?null:T.errors))}},directives:[g.O5,p.oB,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,c.w9],styles:['.relative-container[_ngcontent-%COMP%]{position:relative;width:100%;height:180px}.absolute-container[_ngcontent-%COMP%]{position:absolute;top:-85px;width:100%;text-align:center}.square[_ngcontent-%COMP%]{background-color:#fff;position:relative;display:inline-block;min-width:250px;max-width:300px;width:min-content;font-size:5rem;border-radius:50%;border:5px solid black}.square[_ngcontent-%COMP%]:after{content:"";display:block;padding-bottom:100%}.icon-container[_ngcontent-%COMP%]{position:absolute;top:-5%;left:18%}.img-container[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}.img-selected[_ngcontent-%COMP%]{width:100%;max-height:30vh;object-fit:cover;object-position:center;border:3px solid black;padding:2px}']}),n})()}];let xe=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[i.u5,g.ez,c.A0,i.UX,p.zk.forRoot(),C.Bz.forChild(he)]]}),n})()},830:(w,d,u)=>{u.d(d,{o:()=>p});var g=u(7537);function C(c){return e=>e.value&&c!=e.value?{matchstring:c}:null}var i=u(1514);let p=(()=>{class c{constructor(){this.emailRegex=/^[a-zA-Z\xf10-9!#$%&'*+.\-/=?^_`{|}~]{1,}@{1}([a-z]){1,}\.[a-z]{2,}$/,this.emailOrCodeRegex=/(^[0-9]{4}$)|(^[a-zA-Z\xf10-9!#$%&'*+.\-/=?^_`{|}~]{1,}@{1}([a-z]){1,}\.[a-z]{2,}$)/}GetFormControlByName(m,_){return m.controls.hasOwnProperty(_)?m.get(_):null}ResetForm(m){m.reset()}ClearFormControls(m){for(const _ in m.controls)Object.prototype.hasOwnProperty.call(m.controls,_)&&m.removeControl(_)}FormatControlName(m=""){return m.replace(/ /gi,"_").toUpperCase()}OnPasswordChange(m,_,h){const Z=this.GetFormControlByName(m,_),f=this.GetFormControlByName(m,h);null!=Z&&null!=f&&(f.setValidators([g.kI.required,C(Z.value)]),f.updateValueAndValidity({onlySelf:!0}))}}return c.\u0275fac=function(m){return new(m||c)},c.\u0275prov=i.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()}}]);