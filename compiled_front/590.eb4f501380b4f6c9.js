"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[590],{3854:(b,p,n)=>{n.r(p),n.d(p,{AttendOrderModule:()=>z});var u=n(6019),m=n(9845),g=n(7537),c=n(6250),e=n(1514),l=n(7754),d=n(3149),s=n(754),v=n(6588),_=n(9853),h=n(8036);function A(r,a){1&r&&(e.TgZ(0,"span"),e._uU(1,"Temrinar pedido"),e.qZA())}function T(r,a){1&r&&(e.TgZ(0,"span"),e._UZ(1,"i",15),e.qZA())}function x(r,a){if(1&r&&(e.TgZ(0,"div",16),e.TgZ(1,"div",17),e.TgZ(2,"div",18),e.TgZ(3,"b"),e._uU(4,"Usuario"),e.qZA(),e.qZA(),e.TgZ(5,"div",18),e._uU(6),e.qZA(),e.TgZ(7,"div",18),e.TgZ(8,"b"),e._uU(9,"Direcci\xf3n"),e.qZA(),e.qZA(),e.TgZ(10,"div",18),e._uU(11),e.qZA(),e.TgZ(12,"div",19),e._uU(13),e.qZA(),e.TgZ(14,"div",20),e._uU(15),e.qZA(),e.qZA(),e.qZA()),2&r){const t=e.oxw();e.xp6(6),e.lnq(" ",t.order.user.name," - ",t.order.user.email," - ",t.order.user.cellphone?t.order.user.cellphone:"Sin n\xfamero registrado"," "),e.xp6(5),e.hij(" ",t.GetStreetAddress(t.order.address)," "),e.xp6(2),e.AsE(" ",null!=t.order.address&&t.order.address.colony?null==t.order.address?null:t.order.address.colony:"Sin colonia"," - ",null!=t.order.address&&t.order.address.postalCode?null==t.order.address?null:t.order.address.postalCode:"45819"," "),e.xp6(2),e.hij(" ",null==t.order.address?null:t.order.address.references," ")}}function O(r,a){if(1&r&&e._UZ(0,"img",33),2&r){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("src",o.file.GenerateFileURL(t.images[0].partialURL),e.LSH)("alt",t.images[0].name)}}function C(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).TogglePackedProduct(i)}),e._uU(1," Empaquetar "),e._UZ(2,"i",35),e.qZA()}}function y(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).TogglePackedProduct(i)}),e._uU(1," Desempaquetar "),e._UZ(2,"i",37),e.qZA()}}function k(r,a){if(1&r&&(e.TgZ(0,"div",22),e.TgZ(1,"div",23),e.TgZ(2,"div",24),e.YNc(3,O,1,2,"img",25),e.qZA(),e.TgZ(4,"div",26),e.TgZ(5,"div",27),e.TgZ(6,"label",28),e._uU(7,"Clave"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"div",27),e.TgZ(10,"label",28),e._uU(11,"Nombre"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"div",29),e.TgZ(14,"label",28),e._uU(15,"Cantidad"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"div",30),e.YNc(18,C,3,0,"button",31),e.YNc(19,y,3,0,"button",32),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r){const t=a.$implicit;e.xp6(3),e.Q6J("ngIf",null==t||null==t.images?null:t.images.length),e.xp6(5),e.hij(" ",t.key," "),e.xp6(4),e.hij(" ",t.name," "),e.xp6(4),e.hij(" ",t.quantity," "),e.xp6(2),e.Q6J("ngIf",!t.packed),e.xp6(1),e.Q6J("ngIf",t.packed)}}function q(r,a){if(1&r&&(e.ynx(0),e.YNc(1,k,20,6,"div",21),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.order.products)}}function U(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",38),e.TgZ(1,"div",39),e.TgZ(2,"h3",40),e._uU(3,"Numero de rastreo"),e.qZA(),e.qZA(),e.TgZ(4,"div",41),e.TgZ(5,"div"),e._uU(6," Este es el n\xfamero de rastreo del paquete "),e.TgZ(7,"b"),e._uU(8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",42),e.TgZ(10,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.modal.CloseModal(),i.router.GoToRoute("pedidos")}),e._uU(11," Cerrar "),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(8),e.Oqu(t.order.fedexTrackingNumber)}}const S=[{path:"",component:(()=>{class r{constructor(t,o,i,f,Z,I){this.activeRoute=t,this.http=o,this.file=i,this.router=f,this.toast=Z,this.modal=I,this.orderId=0,this.order=null,this.loading={getting:!1,updating:!1}}ngOnInit(){this.activeRoute.params.subscribe(t=>{this.orderId=Number(t.orderId),this.GetOrder()})}GetStreetAddress(t){if(!t)return"P. Sherman calle wallaby #42 Sidney";let o=`${t.street} #${t.externalNumber}`;return t.internalNumber&&(o=o.concat(` int. ${t.internalNumber}`)),o}GetOrder(){this.loading.getting=!0,this.http.Get(`Orders/${this.orderId}`).subscribe(t=>{this.order=t,this.loading.getting=!1},t=>{console.error("Error al obtener la orden",t),this.loading.getting=!1})}FinishOrder(t){this.loading.updating=!0,"card"==this.order.paymentMethod&&this.order.addressId?this.http.Post(`Orders/${this.orderId}/CreateShipment`,{}).subscribe(o=>{this.http.Patch(`Orders/${this.orderId}/SendOrder`,{}).subscribe(i=>{this.order.fedexTrackingNumber=o,this.toast.ShowDefaultSuccess("Orden actualizada correctamente"),this.modal.OpenModal(t),this.loading.updating=!1},i=>{console.error("Error al actualizar la orden",i),this.toast.ShowDefaultDanger(508==i.error.error.errorCode?"El pedido ha sido cancelado":"Error al actualizar orden"),this.loading.updating=!1})},o=>{console.error("Error al crear el pedido de FedEx",o),this.toast.ShowDefaultDanger("Error al crear pedido FedEx"),this.loading.updating=!1}):this.http.Patch(`Orders/${this.orderId}/SendOrder`,{}).subscribe(o=>{this.toast.ShowDefaultSuccess("Orden actualizada correctamente"),this.modal.OpenModal(t),this.loading.updating=!1},o=>{console.error("Error al actualizar la orden",o),this.toast.ShowDefaultDanger(508==o.error.error.errorCode?"El pedido ha sido cancelado":"Error al actualizar orden"),this.loading.updating=!1})}TogglePackedProduct(t){t.packed=!t.hasOwnProperty("packed")||!t.packed}AllProductsPacked(){return!!this.order&&this.order.products.every(t=>t.packed)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.gz),e.Y36(l.O),e.Y36(d.I),e.Y36(s.c),e.Y36(v.k),e.Y36(_.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-attend-order"]],decls:24,vars:10,consts:[[1,"row","mt-3","mb-4"],[1,"col-12","view-title","d-flex","justify-content-between","align-items-center"],[1,"d-inline-block"],[1,"clickeable",3,"click"],[1,"zmdi","zmdi-arrow-back"],[1,"btn","btn-success",2,"font-size","1.2rem",3,"disabled","click"],[4,"ngIf"],[1,"row"],[1,"col-12","mb-4"],[2,"font-size","1.4rem"],["class","card address-card",4,"ngIf"],[1,"col-12"],[3,"onSuccess"],["confirmIdentity",""],["showOrderTrackingNumber",""],[1,"zmdi","zmdi-spinner","zmdi-hc-spin"],[1,"card","address-card"],[1,"card-body","pt-0"],[1,"form-group","m-0"],[1,"form-group","m-0",2,"text-transform","uppercase"],[1,"form-group","m-0",2,"max-height","3rem"],["class","col-12 col-xl-6 mb-3",4,"ngFor","ngForOf"],[1,"col-12","col-xl-6","mb-3"],[1,"row","product-card"],[1,"col-12","col-md-6","col-xl-4","d-flex","h-100","align-items-center","px-0"],["class","product-image",3,"src","alt",4,"ngIf"],[1,"col-12","col-md-6","col-xl-8","mt-3","px-4"],[1,"product-info",2,"font-size","1.2rem"],[1,"product-label"],[1,"product-info"],[1,"mb-3"],["class","btn btn-outline-success btn-block",3,"click",4,"ngIf"],["class","btn btn-outline-danger btn-block",3,"click",4,"ngIf"],[1,"product-image",3,"src","alt"],[1,"btn","btn-outline-success","btn-block",3,"click"],[1,"zmdi","zmdi-check","zmdi-hc-lg","ml-2"],[1,"btn","btn-outline-danger","btn-block",3,"click"],[1,"zmdi","zmdi-close","zmdi-hc-lg","ml-2"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"modal-footer"],[1,"btn","btn-primary",3,"click"]],template:function(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"span",3),e.NdJ("click",function(){return o.router.GoToRoute("pedidos")}),e._UZ(4,"i",4),e.qZA(),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"div",2),e.TgZ(8,"button",5),e.NdJ("click",function(){return e.CHM(i),e.MAs(21).show()}),e.YNc(9,A,2,0,"span",6),e.YNc(10,T,2,0,"span",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",7),e.TgZ(12,"div",8),e.TgZ(13,"div",9),e._uU(14," Datos "),e.qZA(),e.YNc(15,x,16,7,"div",10),e.qZA(),e.TgZ(16,"div",11),e.TgZ(17,"div",9),e._uU(18," Productos "),e.qZA(),e.qZA(),e.YNc(19,q,2,1,"ng-container",6),e.qZA(),e.TgZ(20,"app-verify-identity-modal",12,13),e.NdJ("onSuccess",function(){e.CHM(i);const Z=e.MAs(23);return o.FinishOrder(Z)}),e.qZA(),e.YNc(22,U,12,1,"ng-template",null,14,e.W1O)}2&t&&(e.xp6(5),e.AsE(" Pedido ",o.orderId?o.orderId:""," - ",o.order?e.xi3(6,7,o.order.creationDate,"dd/MM/yyyy"):""," "),e.xp6(3),e.Q6J("disabled",!o.AllProductsPacked()||o.loading.updating),e.xp6(1),e.Q6J("ngIf",!o.loading.updating),e.xp6(1),e.Q6J("ngIf",o.loading.updating),e.xp6(5),e.Q6J("ngIf",o.order),e.xp6(4),e.Q6J("ngIf",o.order))},directives:[u.O5,h.S,u.sg],pipes:[u.uU],styles:[".product-image[_ngcontent-%COMP%]{width:100%;max-height:25vh;min-height:200px;object-fit:cover;object-position:center}.product-card[_ngcontent-%COMP%]{border:2px solid black;border-radius:12px;overflow:hidden}.product-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.address-card[_ngcontent-%COMP%]{border:2px solid black;box-shadow:none;border-radius:12px}"]}),r})()}];let z=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[g.u5,u.ez,g.UX,c.t,m.Bz.forChild(S)]]}),r})()},830:(b,p,n)=>{n.d(p,{o:()=>c});var u=n(7537);function m(e){return l=>l.value&&e!=l.value?{matchstring:e}:null}var g=n(1514);let c=(()=>{class e{constructor(){this.emailRegex=/^[a-zA-Z\xf10-9!#$%&'*+.\-/=?^_`{|}~]{1,}@{1}([a-z]){1,}\.[a-z]{2,}$/,this.emailOrCodeRegex=/(^[0-9]{4}$)|(^[a-zA-Z\xf10-9!#$%&'*+.\-/=?^_`{|}~]{1,}@{1}([a-z]){1,}\.[a-z]{2,}$)/}GetFormControlByName(d,s){return d.controls.hasOwnProperty(s)?d.get(s):null}ResetForm(d){d.reset()}ClearFormControls(d){for(const s in d.controls)Object.prototype.hasOwnProperty.call(d.controls,s)&&d.removeControl(s)}FormatControlName(d=""){return d.replace(/ /gi,"_").toUpperCase()}OnPasswordChange(d,s,v){const _=this.GetFormControlByName(d,s),h=this.GetFormControlByName(d,v);null!=_&&null!=h&&(h.setValidators([u.kI.required,m(_.value)]),h.updateValueAndValidity({onlySelf:!0}))}}return e.\u0275fac=function(d){return new(d||e)},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9853:(b,p,n)=>{n.d(p,{Z:()=>g});var u=n(1514),m=n(1859);let g=(()=>{class c{constructor(l){this.modalService=l,this.modalRefs=[]}OpenModal(l,d=!0){const s=this.modalService.show(l,{backdrop:"static",keyboard:d});this.modalRefs.push(s)}CloseModal(){this.modalRefs.length&&this.modalRefs.pop().hide()}}return c.\u0275fac=function(l){return new(l||c)(u.LFG(m.tT))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()}}]);